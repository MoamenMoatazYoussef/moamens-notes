# AWS Services - Relational Database Service RDS
Our database is usually put in a separate, private subnet, so that only our EC2 instances have access to it, not the internet or outsiders.

## To SQL or Not to SQL - That is the question
There are two types of Databases:
- Relational, or SQL databases.
- Non-relational, or NoSQL databases.

There are two databases in AWS:
- RDS, which is a SQL database service.
- DynamoDB, which is a NoSQL database.

### RDS
The RDS isn't itself a database, it's a database *service*, it offers a wide range of SQL databases to choose from, like: Amazon Aurora (An Amazon-developed database compatible with MySql, sadly this is the only option that's not Free-Tier eligible), MySql, MSSQL, MariaDB, PostgreSQL, and Oracle.

The RDS service itself provides resizable capacity for a relationshal database and manages common database administration tasks. So, we don't have to install or manage any database software, we just provision an instance in the cloud.

**Steps** <br/>
In the AWS Console,
- Go to RDS.
- Create Database.
- You can see the different options, listed under the title *Engines*.

**Structure** <br/>
Like any SQL database, it stores data in *Tables* of *rows* and *columns*.

### DynamoDB
Like RDS, it's a database *service*, but unlike RDS, it doesn't offer different database options, it IS a database in of itself, it can replace other NoSql options like MongoDb, Cassandra DB, Oracle NoSql.

In the AWS Console,
- Go to DynamoDB.
- Notice that you only have the option to create tables and stuff i.e. *use* the database.

**Structure** <br/>
It stores data in key-value *documents* that is like JSON.

## Connecting to and Privisioning an RDS Database
Remember, we don't want our RDS database to be internet accessible, so it's best to provision it in a private subnet.
To do that, we need to:
- Create a private subnet. (That has a private route table separate from the route table)
- Configure some *Security Groups* so that our EC2 instances can still communicate with the database.
- The same for *NACL*.

Then, we as developers want to connect to the EC2 instance, then the EC2 instance connect to the database.
We need to be able to connect through
- Internet,
- the internet gateway, 
- route table, 
- NACL, 
- security groups, 
- private route table,
- to the RDS.

So all of these components must work together to make that happen, this is called *SSH Tunneling*.

**Development Steps** <br/>
1. Create a private Subnet group.
2. Create two subnets.
3. Insert our two private subnets into the new subnet group.
4. 

**Step 1** <br/>
In the AWS console,
- Go to RDS.
- Subnet Groups.
- Create a DB subnet group:
    + Give it a name: EssentialSubnetGroup (Set it in the description also)
    + VPC: select your VPC.
    + Availability Zone: choose two zones, for example us-east-1a and us-east-1c.
    + Click Create

**Step 2** <br/>
- Go back to the RDS dashboard
- Create Database, select MySQL, scroll down:
    + Give it a name: essentialdb
    + master username: admin
    + Create a password
    + DB instance size: burstable
    + t2.micro
    + Storage as default
    + Connectivity: default VPC
    + Publicly accessible: No
    + VPC security group: create new, call it essentialSG.
    + Availability zone: No preference.
    + Database port: 3306
    + Backup: change the backup retention period to 0 days.
    + Deletion protection: disable it.
    + Create Database.
The database will start creating.

**Step 3** <br/>
- Click on the database.
- Connectivity & Security tab, we'll need some stuff from here when we connect to our database.

**Step 4** <br/>
- Go back to AWS Console
- VPC
- Security Groups
- Select the security group we created when we made the database.
- Inbound rules.
- Edit rules.
- Change the rule to 0.0.0.0/0 to allow any TCP connection to port 3306 (Not a best practice, but for now we'll set it here)
- Add another rule:
    + Type: SSH
    + Port range: 22
    + 0.0.0.0/0
- Add another rule:
    + Type: All Traffic
    + same stuff.
- Save rules.
- Network ACLs, if there are no inbound rules that are similar to above, make them.

**Step 4** <br/>
- We can't access our RDS databas from the AWS console, so go to a new tab in your browser and download MySQL Workbench, we'll need:
    + .pem file we made when we created our EC2 instance earlier.
    + SSH hostname/public IP address of that instance.
    + SSH username for the instance.
    + Port 3306 is open.
    + Enter the username and password.
- Open the workbench.
- Add a MySQL Connection:
    + Give it a name.
    + Method: Standard TCP/IP over SSH
    + SSH Hostname: Go to the AWS Console, get the EC2 instance public IP or hostname.
    + SSH Username: Get the EC2 instance username.
    + SSH Key file: Browse to the .pem file you downloaded for the EC2 instance earlier.
    + MySQL Hostname: go to RDS, Databases, select your database, copy what's under Endpoint.
    + MySQL Server Port: 3306
    + Username: the username you used for the database.
    + Password: the password you used for the database. (Choose Store in keychain).
- Create.

That's it, now you're connected to the RDS Database through the MySQL Workbench :smile: <br/>