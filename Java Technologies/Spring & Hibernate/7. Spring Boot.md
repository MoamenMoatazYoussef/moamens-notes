# Spring Boot

## Table of Contents

## Tips
- sysout means System.out.println, I'm lazy.
- We'll use Maven for this section, so check out the Maven notes.
- This is not a theoretical reference for Spring Boot, this is a practical approach to it, for a reference see:
https://spring.io/projects/spring-boot

## Introduction
### So what is the problem here?
Building a Spring app is hard because it contains a lot of decisions to make. <br/>
- which maven archetype to use,
- which maven dependencies to use,
- how do I set up config, xml or java,
- which server to install and how to install it,
etc. <br/>

And these are just the basics, if we dig deeper we'll find tons of configurations to do, which is very error-prone.

This is where Spring Boot comes in. <br/>

**What is Spring Boot?** <br/>
It's a project that's built on Spring that provides many benefits:
- performs auto-configuration,
- helps resolve dependency conflicts in Maven or Gradle projects (Gradle is another build tool), and
- provides an embedded server to run on, so now there's no need to install a server separately.

**Running and Deploying Spring Boot apps**<br/>
WE can run our app from an IDE or command-line as a JAR file, it'll start the embedded server and run the app on the server. <br/>

Also, Spring supports WAR files, we can deploy our app as a WAR file, where our code only will be included in the WAR file, without the embedded server. <br/>

**FAQ Spring Boot** <br/>
Q: Does Spring Boot replace other Spring technologies e.g. Core, AOP, MVC, REST, etc.?
A: No, it uses those technologies in the background, and we write normal Spring code. <br/>

Q: Does Spring Boot run faster than normal Spring code?
A: No, Spring Boot makes it easier to get started in Development, but it uses the same code as Spring. <br/>

Q: Do I need a special IDE for Spring Boot?
A: No, you can use any IDE or text editor, you can make use of the Spring Tool Suite (STS), a collection of IDE plugins provided by the Spring team to help development in Spring, but is not required.


**Spring Initializer** <br/>
Spring boot provides a Spring initializer, a website where we go to it, select dependencies, and it will create a Maven/Gradle project where we can download it and import it in our IDE.

Spring Initializer: http://start.spring.io <br/>
- Go to the website, you'll find it very easy to use, do your stuff and select Generate.
- A .rar file will be downloaded, unzip it and put the unzipped folder anywhere you want.
- Open Eclipse, in the File Menu, import  and Existing Maven Project, select the folder you unzipped.
- It'll appear on your IDE, with a lot of files and a main app in src/main/java, inside it there are some code, run this app as a JAVA APP, not on a server.
- Notice that the output log will have "Tomcat started", this is the embedded server in Spring Boot :)

### Developing a REST Controller on Spring Boot
In the project we created, we'll create a simple REST controller that says:
```
"Hello World!, Time on Server: <time on server/>"
```

Creating a REST controller is very easy:
- Create a new package "com.luv2code.mycoolapp.rest"
- Create this class:
``` Java
@RestController 
public class myRESTController {
	@GetMapping("/")
    public String sayHello() {
        return "Hello World!, Time on Server: " + LocalDateTime.now();
    }
}
```

Run the main app in src/main/java/com.luv2code.mycoolapp. <br/>
Then open a browser, go to localhost:8080, see the result :) <br/>

If you used Tomcat before, you know the port problems and the annoying stuff we had to deal with, now we don't have to, thanks to the embedded server :'D <br/>

Also, we didn't have to add any dependencies to Maven, that's a life saver :'D <br/>

### The Structure of a Spring Boot Project
Spring Boot uses Maven directory structure, and there are other files:
- mvnw: Maven Wrapper files, they allow us to run Maven projects without installing Maven or having it present on your path, also they download the correct version of Maven if it isn't already downloaded.
    + mvnw.cmd: for MS Windows.
    _ mvnw.sh: for Linux/Mac.
    They have stuff like mvn clean compile test, etc.

- pom.xml: the usual maven pom file, with additional stuff. 
    + in the dependencies element you'll find some dependencies added by spring Boot, they're all in the groupId org.springframework.boot.
    + plugins to package an executable JAR or WAR file.

- src/main/resources/application.properties: this file can be used to add Spring Boot properties, and then injected normally, like:
    + "server.port=9001" to change the default port that Spring boot runs on.
    + Custom properties, like "coach.name", like the properties file we created way back in Spring Core.

- src/main/resources/static: here we put HTML files, CSS, JS, images, etc. and they are auto-loaded.
- src/main/resources/templates: templates are saved and loaded from here, Spring Boot includes auto-config for template engines like:
    - FreeMarker.
    - Thymeleaf.
    - Mustache.

- src/test: where the unit tests reside.

**WARNING** <br/>
If your app will be packaged as JAR, ***DO NOT USE*** THE src/main/webapp directory.
It works only with WAR packaging, and is silently ignored by most build tools if you generate a JAR.
**Trust me**, you'll spend many, many hours trying to solve this issue.

### Java Source Code
We saw a new annotation #SpringBootApplication, this annotation:
- enables auto-config support for spring boot,
- enables component scanning,
- able to register beans with @Bean or import other config classes.

Basically, this annotation is like using the fusion card from yu-gi-oh to combine @ComponentScan, @Configuration, and @EnableAutoConfiguration.

**Some practices in Spring Boot code** <br/>
The best practice is to place the Main app class in the root package, above other packages, why?
- Allows leveraging of default component scanning.
- No need to reference the base package name.

If we have other packages outside the root package, we need to specify the base packages to scan in the annotation @SpringBootApplication, like this:
``` java
@SpringBootApplication("com.luv2code.springbootdemo.mycoolapp",
"org.acme.iot.utils",
"edu.cmu.wean")
```

## Spring Boot Starters
As we know, the question of which Maven dependencies are needed, is a hard question to answer.

We needed to add dependencies manually in the pom.xml file, which is error-prone.

One great solution is *Spring Boot Starters*.

**What is that?** <br/>
A collection of Maven dependencies group together, which are tested and verified by the Spring team, makes it much easier to get started development in Spring, and reduces the amount of Maven dependency configuration. 

To add the Spring Boot Starter for web, we just add this dependency (You don't need to add it, wait to know why):
``` xml
<dependency>
	<groupId>org.springframework.boot</groupId>
	<artifactId>spring-boot-starter-web</artifactId>
</dependency>
```
This dependencies has other dependencies like json, tomcat, hibernate, etc.

(here's why) We don't even need to add this dependency manually, it's already added because we just use Spring Initializer to add it.

So, there are 30+ Spring Boot Starters created by the Spring team, like:
- spring-boot-starter-web
- spring-boot-starter-security: adds security.
- spring-boot-starter-data-jpa: DB support with JPA and hibernate.

and many others, check this link out:
www.luv2code.com/spring-boot-starters

To know what's in one of these starters, you can:
- Look at the starter's pom.xml file (which is hard), or:
- Use the IDE, most IDEs have a dependency view feature, to do this in Eclipse:
    + open the pom.xml file,
    + select the tab Dependency Hierarchy,
    + Expand the desired starter,
    + You'll see a list of what's inside.

**Spring Boot Starter Parent** <br/>
A special starter that provides Maven defaults e.g. java version, utf-8, etc.
Also, its version is inherited by all other dependencies, so we don't need to explicitly list the version of each dependency.

